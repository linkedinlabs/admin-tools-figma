<script>
  import { afterUpdate } from 'svelte';
  import FigmaInput from './FigmaInput';
  import FigmaSelectmenu from './FigmaSelectmenu';
  import FigmaTextarea from './FigmaTextarea';
  import FormLabel from './FormLabel';

  export let className = null;
  export let disableActions = false;
  export let disabled = false;
  export let invertView = false;
  export let kind = 'inputText';
  export let labelText = 'Type something…';
  export let placeholder = null;
  export let nameId = 'text-input-id';
  export let value = null;

  const originalValue = value;
  let isDirty = false;

  afterUpdate(() => {
    if (value !== originalValue) {
      isDirty = true;
    } else {
      isDirty = false;
    }
  });
</script>

<span class={className}>
  <FormLabel
    disableActions={disableActions}
    labelText={`${labelText} ${isDirty ? '👎' : '👍'}`}
    invertView={invertView}
    nameId={nameId}
  />

  {#if kind === 'inputText'}
    <FigmaInput
      className="form-element element-type-text"
      invertView={invertView}
      nameId={nameId}
      placeholder={placeholder}
      bind:value={value}
    />
  {/if}

  {#if kind === 'inputTextarea'}
    <FigmaTextarea
      className="form-element element-type-textarea"
      invertView={invertView}
      nameId={nameId}
      placeholder={placeholder}
      bind:value={value}
    />
  {/if}

  {#if kind === 'inputSelect'}
    <FigmaSelectmenu
      className="form-element element-type-select split-50"
      disabled={disabled}
      invertView={invertView}
      nameId={nameId}
      bind:value={value}
    />
  {/if}
</span>
